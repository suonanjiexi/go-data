# Cyber-DB 数据库

一个用Go语言实现的去中心化分布式关系型数据库系统。

## 功能特性

- 基本的数据存储和检索
- 支持丰富的SQL语法
  - 基本的CRUD操作（创建、读取、更新、删除）
  - 条件查询（WHERE子句）
  - 多条件组合查询（AND/OR）
  - 模糊匹配查询（LIKE操作符）
  - 结果排序（ORDER BY）
  - 分页查询（LIMIT/OFFSET）
  - 分组统计（GROUP BY）
  - 聚合函数（MAX、MIN、SUM、AVG）
  - 支持ID自增和唯一性约束
- 高效索引
  - 优化的B+树索引结构
  - 支持普通索引和唯一索引
  - 高性能范围查询
  - 并发安全的索引访问
  - 自动索引维护
- 事务管理
  - 完整的ACID事务支持
  - 多种隔离级别（读未提交、读已提交、可重复读、串行化）
  - 死锁检测和自动处理
  - 事务超时和自动回滚机制
  - 基于MVCC的并发控制
  - 写集合和读集合管理
  - 两阶段锁定协议
  - 分布式事务支持
  - 两阶段提交协议
  - 事务超时管理
  - 故障恢复机制
  - 事务状态追踪
  - 分布式一致性保证
- 锁机制
  - 支持读锁和写锁
  - 锁升级和降级
  - 死锁检测和预防
  - 超时自动释放
  - 等待队列管理
  - 锁粒度优化
- 并发控制
  - 多版本并发控制（MVCC）
  - 乐观并发控制
  - 悲观并发控制
  - 事务隔离保证
  - 并发度优化  - 资源竞争管理
- 持久化存储
  - 数据持久化到磁盘
  - 可配置数据存储路径
  - 崩溃恢复机制
  - 数据一致性保证
  - 日志记录和回放
- 网络服务接口
  - TCP协议通信
  - 支持多客户端并发连接
  - 连接超时管理
  - 高性能并发处理
  - 连接池管理
  - 负载均衡
  - 动态节点管理
  - 自动故障转移
  - 数据分片路由
  - 负载监控和调整

## 项目结构

- `cmd/`: 命令行工具
  - `cyberdb/`: 数据库服务器程序
- `pkg/`: 核心包
  - `storage/`: 存储引擎，负责数据的持久化存储
  - `parser/`: SQL解析器，解析和验证SQL语句
  - `transaction/`: 事务管理，处理事务的开始、提交和回滚
  - `server/`: 网络服务，处理客户端连接和请求
- `examples/`: 示例代码
  - 包含客户端示例程序
  - 提供SQL使用示例

## 快速开始

1. 编译服务器：
```bash
go build -o cyberdb ./cmd/cyberdb
```

2. 运行服务器：
```bash
# 使用默认配置
./cyberdb

# 或指定配置
./cyberdb -host 127.0.0.1 -port 3306 -db ./mydata
```

3. 使用客户端连接：
```bash
# 编译并运行示例客户端
go build -o client ./examples/client.go
./client

# 运行测试示例
./client --test
```

更多详细信息和使用示例，请参考 `examples/README.md`。

## 注意事项

1. 确保防火墙允许指定端口的TCP连接
2. 数据库文件路径需要有写入权限
3. 使用Ctrl+C可以优雅地关闭服务器
4. 默认事务超时时间为30秒
5. 客户端连接超时时间为5分钟
6. 事务隔离级别默认为可重复读（RepeatableRead）
7. 死锁检测会自动中止较新的事务
8. 超时的事务会被自动清理
9. 建议在高并发场景下使用合适的索引
10. 大型事务建议适当调整超时时间

## 贡献

欢迎提交Issue和Pull Request来帮助改进项目。
